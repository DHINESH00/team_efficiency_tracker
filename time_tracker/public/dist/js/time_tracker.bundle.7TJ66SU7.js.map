{
  "version": 3,
  "sources": ["../../../../../apps/time_tracker/time_tracker/public/js/time_tracker.bundle.js"],
  "sourcesContent": ["frappe.ui.form.Form =class TimerFrom extends frappe.ui.form.Form{\n      async render_form(val){\n            await super.render_form(val)\n                add_stopwatch()\n        \n        }\n        save(save_action, callback, btn, on_error){\n            \n            var locally_saved = cur_frm.is_new()\n            var workflow_state=cur_frm.doc.workflow_state?cur_frm.doc.workflow_state:\"\"\n            var status=cur_frm.doc.status?cur_frm.doc.status:\"\"\n            var dt=frappe.boot.time_tracker_dt_list || [];\n            if (dt.includes(cur_frm.doctype)){\n            super.save(save_action, callback, btn, on_error).then(()=>{\n\n                var Action=\"\"\n                if( locally_saved){\n                    Action =\"Create\"\n                }\n                else if (save_action==\"save\" ||save_action==\"Save\"){\n                    Action=\"Update\"\n                }\n                else{\n                    Action= save_action\n                }\n                var dt=frappe.boot.time_tracker_dt_list || [];\n                if (dt.includes(cur_frm.doctype)){\n                frappe.call({\n                    async: false,\n                    method: \"time_tracker.time_tracker.doctype.activity_timer_log.activity_timer_log.create_activity_time_log\",\n                    args: {\n                        dt: cur_frm.doctype,\n                        dn: cur_frm.doc.name,\n                        action: Action,\n                        user: frappe.session.user,\n                        time_taken: cur_frm.doc.time_tracker_value,\n                        status:status,\n                        workflow_state:workflow_state\n                        }\n                }).then(()=>{\n\n                    \n\n                })\n            }\n            })\n        }\n        else{\n            super.save(save_action, callback, btn, on_error)\n        }\n       \n    }\n    \n\n    \n}\n\nfunction add_stopwatch(time_tracker_value = 0) {\n    // Declare interval variable to manage the stopwatch interval\n    debugger\n    var interval = sessionStorage.getItem('intrval');\n\n    // Get the list of data trackers\n    var dt = frappe.boot.time_tracker_dt_list || [];\n    if (dt.includes(cur_frm.doctype)) {\n\n        // Stopwatch HTML\n        const timer = `\n            <div class=\"btn btn-primary btn-sm primary-action\">\n                <span class=\"hours\">00</span>\n                <span class=\"colon\">:</span>\n                <span class=\"minutes\">00</span>\n                <span class=\"colon\">:</span>\n                <span class=\"seconds\">00</span>\n            </div>`;\n\n        // Add stopwatch to the form\n        var section = cur_frm.toolbar.page.add_inner_message(timer);\n        var currentIncrement = time_tracker_value || 0;\n\n        // Initialize the timer\n        initialiseTimer();\n\n        function updateStopwatch(increment) {\n            var hours = Math.floor(increment / 3600);\n            var minutes = Math.floor((increment - (hours * 3600)) / 60);\n            var seconds = increment - (hours * 3600) - (minutes * 60);\n\n            $(section).find(\".hours\").text(hours < 10 ? (\"0\" + hours.toString()) : hours.toString());\n            $(section).find(\".minutes\").text(minutes < 10 ? (\"0\" + minutes.toString()) : minutes.toString());\n            $(section).find(\".seconds\").text(seconds < 10 ? (\"0\" + seconds.toString()) : seconds.toString());\n        }\n\n        function setCurrentIncrement() {\n            currentIncrement += 1;\n            cur_frm.doc.time_tracker_value = currentIncrement;\n            console.log(cur_frm.doc.time_tracker_value);\n            return currentIncrement;\n        }\n\n        function initialiseTimer() {\n            debugger\n            // Clear any existing interval before starting a new one\n            if (interval) {\n                stopTimer();\n            }\n            \n            interval = setInterval(function() {\n                var current = setCurrentIncrement();\n                updateStopwatch(current);\n            }, 1000);\n            sessionStorage.setItem('intrval',interval);\n        }\n\n        // Optional: Add a way to stop the timer if needed\n        function stopTimer() {\n            if (interval) {\n                clearInterval(interval);\n                interval = null; // Set to null to indicate the timer is stopped\n            }\n        }\n\n        // For demonstration, stop the timer after 10 seconds\n       \n    }\n}\n"],
  "mappings": "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",
  "names": []
}
